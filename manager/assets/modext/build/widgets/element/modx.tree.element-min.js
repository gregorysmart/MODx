MODx.tree.Element=function(A){A=A||{};Ext.applyIf(A,{rootVisible:false,enableDrag:true,enableDrop:true,title:"",url:MODx.config.connectors_url+"layout/tree/element.php"});MODx.tree.Element.superclass.constructor.call(this,A)};Ext.extend(MODx.tree.Element,MODx.tree.Tree,{forms:{},windows:{},stores:{},showNewCategory:function(A,B){var C=this.cm.activeNode.id.substr(2);if(!this.windows.createCategory){this.windows.createCategory=new MODx.window.CreateCategory({success:this.refresh,scope:this})}this.windows.createCategory.show(B.target)},removeCategory:function(A,B){var C=this.cm.activeNode.id.substr(2).split("_");C=C[2];MODx.msg.confirm({title:_("warning"),text:_("category_confirm_delete"),connector:MODx.config.connectors_url+"element/category.php",params:{action:"delete",id:C},scope:this,success:this.refresh})},duplicateElement:function(F,D,E,B){var C={id:E,type:B,name:_("duplicate_of")+this.cm.activeNode.text};if(!this.windows.duplicateElement){this.windows.duplicateElement=new MODx.window.DuplicateElement({success:this.refresh,scope:this,record:C})}else{var A=MODx.config.connectors_url+"element/"+B+".php";this.windows.duplicateElement.fp.getForm().url=A}this.windows.duplicateElement.setValues(C);this.windows.duplicateElement.show(D.target)},removeElement:function(D,A){var C=this.cm.activeNode.id.substr(2);var B=C.split("_");MODx.msg.confirm({title:_("warning"),text:_("remove_this_confirm")+" "+B[0]+"?",connector:MODx.config.connectors_url+"element/"+B[0]+".php",params:{action:"delete",id:B[2]},scope:this,success:this.refresh})},_createElement:function(C,D){var G=this.cm.activeNode.id.substr(2);var F=G.split("_");var B=F[0]=="type"?F[1]:F[0];var E=F[0]=="type"?0:(F[1]=="category"?F[2]:F[3]);var A=MODx.action["element/"+B+"/create"];this.redirect("index.php?a="+A+"&category="+E);this.cm.hide();return false},_handleDrop:function(B){var A=B.target;if(B.point=="above"||B.point=="below"){A=B.target.parentNode}if(!this.isCorrectType(B.dropNode,A)){return false}return B.target.getDepth()>0},isCorrectType:function(A,C){var B=false;if(C.attributes.type==A.attributes.type){if(!(C.parentNode&&((A.attributes.cls=="folder"&&C.attributes.cls=="folder"&&A.parentNode.id==C.parentNode.id)||C.attributes.cls=="file"))){B=true}}return B}});Ext.reg("tree-element",MODx.tree.Element);MODx.window.DuplicateElement=function(A){A=A||{};Ext.applyIf(A,{title:_("element_duplicate"),url:MODx.config.connectors_url+"element/"+A.record.type+".php",action:"duplicate",fields:[{xtype:"hidden",name:"id"},{xtype:"textfield",fieldLabel:_("element_name_new"),name:"name",width:250}]});MODx.window.DuplicateElement.superclass.constructor.call(this,A)};Ext.extend(MODx.window.DuplicateElement,MODx.Window);Ext.reg("window-element-duplicate",MODx.window.DuplicateElement);