MODx.tree.UserGroup=function(A){A=A||{};Ext.applyIf(A,{title:_("user_groups"),url:MODx.config.connectors_url+"security/group.php",root_id:"n_ug_0",root_name:_("user_groups"),enableDrag:true,enableDrop:true,rootVisible:false,ddAppendOnly:true,useDefaultToolbar:true,tbar:[{text:_("user_group_new"),scope:this,handler:this.create.createDelegate(this,[true],true)}]});MODx.tree.UserGroup.superclass.constructor.call(this,A)};Ext.extend(MODx.tree.UserGroup,MODx.tree.Tree,{windows:{},addUser:function(B,C){var E=this.cm.activeNode;var D=E.id.substr(2).split("_");D=D[1];if(D==undefined){D=0}var A={user_group:D};if(!this.windows.adduser){this.windows.adduser=new MODx.window.AddUserToUserGroup({record:A,success:this.refresh,scope:this})}else{this.windows.adduser.setValues(A)}this.windows.adduser.show(C.target)},create:function(B,D,F){F=F||false;if(F==false){var E=this.cm.activeNode;var C=E.id.substr(2).split("_");C=C[1];if(C==undefined){C=0}}else{var C=0}var A={parent:C};if(!this.windows.create){this.windows.create=new MODx.window.CreateUserGroup({record:A,success:this.refresh,scope:this})}else{this.windows.create.setValues(A)}this.windows.create.show(D.target)},update:function(A,B){var D=this.cm.activeNode;var C=D.id.substr(2).split("_");C=C[1];Ext.Ajax.request({url:this.config.url,params:{action:"get",id:C},scope:this,success:function(E,F){E=Ext.decode(E.responseText);if(!this.windows.update){this.windows.update=new MODx.window.UpdateUserGroup({scope:this,success:this.refresh,record:E.object})}else{this.windows.update.setValues(E.object)}this.windows.update.show(B.target)}})},remove:function(A,B){var D=this.cm.activeNode;var C=D.id.substr(2).split("_");C=C[1];MODx.msg.confirm({title:_("warning"),text:_("confirm_delete_user_group"),connector:this.config.url,params:{action:"remove",id:C},scope:this,success:this.refresh})},removeUser:function(C,D){var E=this.cm.activeNode;var A=E.id.substr(2).split("_");A=A[1];var B=E.parentNode.id.substr(2).split("_");B=B[1];MODx.msg.confirm({title:_("warning"),text:_("confirm_remove_user_from_group"),connector:this.config.url,params:{action:"removeUser",user_id:A,group_id:B},scope:this,success:this.refresh})}});Ext.reg("tree-usergroup",MODx.tree.UserGroup);MODx.window.UpdateUserGroup=function(A){A=A||{};Ext.applyIf(A,{title:_("user_group_update"),height:150,width:375,url:MODx.config.connectors_url+"security/group.php",action:"update",fields:[{xtype:"hidden",name:"id"},{xtype:"textfield",fieldLabel:_("name"),name:"name",width:150,allowBlank:false}]});MODx.window.UpdateUserGroup.superclass.constructor.call(this,A)};Ext.extend(MODx.window.UpdateUserGroup,MODx.Window);Ext.reg("window-usergroup-update",MODx.window.UpdateUserGroup);