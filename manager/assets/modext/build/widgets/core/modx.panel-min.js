Ext.namespace("MODx.panel");MODx.Panel=function(A){A=A||{};Ext.applyIf(A,{collapsible:true});MODx.Panel.superclass.constructor.call(this,A);this.config=A};Ext.extend(MODx.Panel,Ext.Panel);Ext.reg("modx-panel",MODx.Panel);MODx.FormPanel=function(A){A=A||{};Ext.applyIf(A,{autoHeight:true,collapsible:true,bodyStyle:"padding: 1em",border:false,method:"POST",errorReader:MODx.util.JSONReader});MODx.Panel.superclass.constructor.call(this,A);this.config=A;this.addEvents({setup:true});this.getForm().addEvents({beforeSubmit:true,success:true});this.fireEvent("setup",A)};Ext.extend(MODx.FormPanel,Ext.FormPanel,{submit:function(B){var A=this.getForm();if(A.isValid()){A.submit({waitMsg:_("saving"),scope:this,failure:function(D,C){MODx.form.Handler.errorExt(C.result,D)},success:function(D,C){if(this.config.success){Ext.callback(this.config.success,this.config.scope||this,[D,C])}this.fireEvent("success",{form:D,result:C.result,options:B,config:this.config});this.fireEvent("setup",this.config)}})}}});Ext.reg("modx-formpanel",MODx.FormPanel);MODx.panel.Wizard=function(A){A=A||{};Ext.applyIf(A,{layout:"card",activeItem:0,resizable:true,collapsible:true,maximizable:true,autoHeight:true,width:750,firstPanel:"",lastPanel:"",defaults:{border:false},modal:true,txtFinish:_("finish"),txtNext:_("next"),txtBack:_("back"),bbar:[{id:"pi-btn-bck",text:A.txtBack||_("back"),handler:this.navHandler.createDelegate(this,[-1]),scope:this,disabled:true},{id:"pi-btn-fwd",text:A.txtNext||_("next"),handler:this.navHandler.createDelegate(this,[1]),scope:this}]});MODx.panel.Wizard.superclass.constructor.call(this,A);this.config=A;this.lastActiveItem=this.config.firstPanel;this._go()};Ext.extend(MODx.panel.Wizard,Ext.Panel,{windows:{},_go:function(){this.getBottomToolbar().items.item(1).setText(this.config.txtNext);this.proceed(this.config.firstPanel)},navHandler:function(B){this.doLayout();var A=this.getLayout().activeItem;if(B==-1){this.proceed(A.config.back||A.config.id)}else{A.submit({scope:this,proceed:this.proceed})}},proceed:function(A){this.doLayout();this.getLayout().setActiveItem(A);if(A==this.config.firstPanel){this.getBottomToolbar().items.item(0).setDisabled(true);this.getBottomToolbar().items.item(1).setText(this.config.txtNext)}else{if(A==this.config.lastPanel){this.getBottomToolbar().items.item(1).setText(this.config.txtFinish)}else{this.getBottomToolbar().items.item(0).setDisabled(false);this.getBottomToolbar().items.item(1).setText(this.config.txtNext)}}}});Ext.reg("modx-panel-wizard",MODx.panel.Wizard);